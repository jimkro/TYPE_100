# 🛠️ 開發迭代紀錄：v9.0

## 🖥️ 選單系統與狀態管理 (Menu System & State Management)
`狀態：遊戲流程完整化`

v9 的核心演進在於「框架的建立」。我們不再讓遊戲在頁面載入後立即開始，而是引入了正式的遊戲狀態機（State Machine），完善了從啟動、戰鬥到失敗重開的完整循環。

### 核心功能進化
* **遊戲狀態機實作 (Game State Management)**：
    * 定義了明確的狀態切換邏輯：`MENU` (主選單)、`PLAYING` (進行中)、`UPGRADE` (升級中)、`GAMEOVER` (遊戲結束)。
    * 確保各狀態間的資源切換與事件監聽不會互相干擾。
* **全新啟動選單 (Start Menu Overlay)**：
    * 實作了半透明的黑色遮罩選單，提供清晰的遊戲標題與操作說明。
    * **互動優化**：玩家現在可以透過按下 `Space` 鍵正式啟動遊戲，給予玩家心理準備時間。
* **重啟機制 (Restart Logic)**：
    * 實作了 `resetGame()` 函式，能在不重新整理網頁的情況下，重置所有遊戲變數（分數、等級、位置、敵人陣列），大幅提升了重複遊玩的便利性。
* **視覺氛圍優化**：
    * **背景深邃化**：將背景色從純黑微調為 `#111`，搭配網格系統，提升了視覺層次感。
    * **UI 層級整理**：優化了 Z-index 邏輯，確保選單與升級卡片始終處於最前端。
* **操作反饋強化**：
    * 修正了在 Game Over 狀態下依然會誤觸輸入緩衝區的 Bug。
    * 強化了選單文字的閃爍效果（Press Space），引導玩家進行交互。

### 數值與邏輯微調
* **初始化序列**：重構了 `init` 流程，確保 Canvas 尺寸與鏡頭座標在第一幀渲染前正確對齊。
* **性能優化**：優化了狀態檢查頻率，減少在非 Play 狀態下的運算消耗。

> **開發筆記**：v9 解決了「遊戲感」中最後的一塊拼圖：流程。有了選單與重啟機制，這款遊戲終於不再只是個技術 Demo，而是一個可以讓使用者反覆挑戰、具備完整體驗的小型作品。